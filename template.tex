\documentclass[12pt,a4paper]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{fontspec}
\usepackage[hidelinks]{hyperref} 
\usepackage{titlesec}
\usepackage{titling}
\usepackage{setspace}
\usepackage{tocloft}
\usepackage{etoolbox}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage{calc}       % allows arithmetic in width specs
\usepackage{ragged2e}   % improves text alignment in table cells
\usepackage{xfp}
\usepackage{array}
\usepackage{booktabs}
\usepackage[spanish, es-noshorthands]{babel}

% --- Pandoc table width safety fix ---
\providecommand{\real}[1]{#1} % neutralize \real if undefined

% ==============================
% FONT
% ==============================
\setmainfont{Liberation Sans}

% ==============================
% HEADER & FOOTER
% ==============================
\pagestyle{fancy}
\fancyhf{} % clear all
\lhead{\includegraphics[height=1.2cm]{image.png}}
\lfoot{Módulo $CODIGO$ - Curso $CURSO$}
\rfoot{Página \thepage\ de \pageref{LastPage}}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.4pt}

% ==============================
% COVER PAGE
% ==============================
\newcommand{\makecover}{
  \thispagestyle{fancy}
  \begin{center}
    \vspace*{0.25\textheight}
    {\Huge\bfseries PROGRAMACIÓN DIDÁCTICA DEL MÓDULO\par}
    \vspace{2cm}
    {\LARGE Código $CODIGO$ - $TITLE$\par}
    \vspace{2cm}
    {\Large $CICLO$\par}
  \end{center}
  \clearpage
}

% ==============================
% TABLE OF CONTENTS
% ==============================
\setcounter{tocdepth}{2}
\newcommand{\maketoc}{
  \thispagestyle{fancy}
  \tableofcontents
  \clearpage
}

% Pandoc list compatibility
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% ==============================
% DOCUMENT BODY
% ==============================
\begin{document}

\makecover
\maketoc

$body$

\end{document}
